<%= link_to("Request by Email", "#", {id: "req-by-email", class: "btn btn-info", role: "button"}) %>

<%= link_to("Request by Phone", "#", {id: "req-by-phone", class: "btn btn-info", role: "button"}) %>

<%= link_to("Cancel", client_service_path(client_id: @client.id, id: @service.id), {class: "btn btn-danger", role: "button", data: { confirm: "Are you sure want to cancel this service?" }, :method => :delete}) %>

<%= link_to("Change to Scheduled", "#", {id: "change_to_scheduled", class: "btn btn-success", role: "button"}) %>


<div id="request-by-email-modal" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="mySmallModalLabel">
          Request by Email
        </h4>
      </div>
      <div class="modal-body">
        <%# if @service.location.email.blank? %>
            <!-- <div class="form-group">    
              <p>There is no email address currently available for this location to make a Request by Email. Please add the email address to <%#= link_to "this location", edit_location_path(@service.location) %> or make the Request by Phone.</p>
            </div>      -->   
        <%# else %>
          <% if @service.tbs_data["request_by_email"].nil? %>
            <%= form_tag request_by_email_client_service_path(@client, @service), html: {role: "form"} do %>

              <% if @service.location.email.blank? %>
              <div class="form-group">  
              <label class="control-label">Email</label>
                <%= email_field_tag "request[email]", nil, {class: "form-control", placeholder: "...", required: "true", id: "request-email-address"} %>              
                </div>
              <% end %>
              

              <div class="form-group">    
                <label class="control-label">Subject</label>
                <%= text_field_tag "request[subject]", generate_demo_email_template(@service).subject, {class: "form-control", placeholder: "subject", required: "true", id: "request-email-subjct"} %>
              </div>

              <div class="form-group">    
                <label class="control-label">Subject</label>
                <%= text_area_tag "request[content]", generate_demo_email_template(@service).content.html_safe, {size: "10x20", class: "form-control", placeholder: "subject", required: "true", id: "request-email-content"} %>
              </div>

              <%= button_tag "Request by Email", {type: "submit", class: "btn btn-primary"} %>
            <% end %>
          <% else %>
            <div class="form-group">    
              <label class="control-label">Date Sent</label>
              <p><%= @service.tbs_data["request_by_email"]["date_sent"] %></p>
            </div>

            <div class="form-group">    
              <label class="control-label">Email</label>
              <p><%= @service.location.email %></p>
            </div>

            <div class="form-group">    
              <label class="control-label">Subject</label>
              <p><%= @service.tbs_data["request_by_email"]["subject"] %></p>
            </div>

            <div class="form-group">    
              <label class="control-label">Content</label>
              <p><%= @service.tbs_data["request_by_email"]["content"].html_safe %></p>
            </div>          
          <% end %>
        <%# end %>
      </div>
    </div>
  </div>
</div>




<div id="request-by-phone-modal" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="mySmallModalLabel">
          Request by Phone
        </h4>
      </div>
      <div class="modal-body">
      <%= form_tag request_by_phone_client_service_path(@client, @service), html: {role: "form"} do %>

        <label>Location Details</label>
        <p>Name: <%= @service.location.name %></p>
        <p>Contact: <%= @service.location.contact %></p>
        <p>Phone: <%= @service.location.phone %></p>

        <div class="form-group">    
          <label class="control-label">Date Time</label>
          <%= text_field_tag "request[datetime]", nil, {class: "form-control", placeholder: "Date Time", required: "true", id: "request-phone-date"} %>
        </div>

        <div class="form-group">    
          <label class="control-label">Person spoken with</label>
          <%= text_field_tag "request[name]", nil, {class: "form-control", required: "true"} %>
        </div>        

        <div class="form-group">    
          <label class="control-label">Result of Conversation</label>
          <%= text_area_tag "request[conversation]", nil, {size: "20x10", class: "form-control", placeholder: nil, required: "true", id: ""} %>
        </div>   

        <%= button_tag "Request by Phone", {type: "submit", class: "btn btn-primary"} %>
      <% end %>
      </div>
    </div>
  </div>
</div>


<div id="changed-to-scheduled-modal" class="modal fade bs-example-modal-sm" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-sm">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="mySmallModalLabel">
          Change to Scheduled
        </h4>
      </div>
      <div class="modal-body">
      <%= form_tag change_to_schedule_client_service_path(@client, @service), html: {role: "form"} do %>

        <div class="form-group">    
          <label class="control-label">Select Date Time</label>
          <%= select_tag "changed_tbs[datetime]", 
          "<option value='first_date'>#{DateTime.parse(@service.tbs_data["first_date"]["start_at"]).strftime("%m/%d/%Y %I:%M %p") + DateTime.parse(@service.tbs_data["first_date"]["end_at"]).strftime(" - %I:%M %p")}</option>" + 
          "<option value='second_date'>#{DateTime.parse(@service.tbs_data["second_date"]["start_at"]).strftime("%m/%d/%Y %I:%M %p") + DateTime.parse(@service.tbs_data["second_date"]["end_at"]).strftime(" - %I:%M %p")}</option>".html_safe, 
          class: "form-control", include_blank: true, require: true %>
        </div>

        <div class="form-group">    
          <label class="control-label">Select BA</label>
          <%= select_tag "changed_tbs[ba_id]", options_from_collection_for_select(BrandAmbassador.find(@service.tbs_data["ba_ids"]), "id", "name"), class: "form-control", include_blank: true, require: true %>
        </div>        

        <%= button_tag "Change to Scheduled", {type: "submit", class: "btn btn-primary"} %>
      <% end %>
      </div>
    </div>
  </div>
</div>