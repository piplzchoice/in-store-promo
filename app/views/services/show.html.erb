<h1 class="page-header">Show Service</h1>

<% if @service.is_not_complete? %>
  <div class="link-new-btn">
    <%= link_to("Set as Conducted", mark_service_as_complete_client_service_path(client_id: @client.id,
      id: @service.id), {class: "btn btn-primary", role: "button"}) %>
  </div>
<% else %>    
  <% unless @service.is_cancelled? %>
    <% if @service.is_reported? %>
      <div class="link-new-btn">
        <%= form_tag(update_status_after_reported_client_service_path(client_id: @client.id, id: @service.id), method: :patch) do -%>
          <%= select_tag "service_status", options_for_select(Service.options_select_after_reported) %>&nbsp;&nbsp;
          <%= submit_tag 'Update' %>
        <% end -%>
      </div>
    <% end %>
  <% end %>
<% end %>
<% if (@service.status == Service.status_confirmed || @service.status == Service.status_conducted) && @service.report.nil? %>
  <div class="link-new-btn">
      <%= link_to("Create Report", new_report_path(service_id: @service.id), 
        {class: "btn btn-success", role: "button"}) %>         
  </div>  
<% end %>         

<label>Status :</label>
<p><%= @service.current_status %></p>

<label>Client :</label>
<p><%= @client.company_name %></p>


<label>Location</label>
<p><%= @service.location.name %></p>

<label>Assigned BA</label>
<p><%= @service.brand_ambassador.name %></p>

<label>Start Date</label>
<p><%= @service.start_at.nil? ? "" : @service.start_at.strftime("%m/%d/%Y %I:%M %p") %></p>

<label>End Date</label>
<p><%= @service.end_at.nil? ? "" : @service.end_at.strftime("%m/%d/%Y %I:%M %p") %></p>

<label>Details</label>
<p><%= @service.details %></p>

<div class="link-new-btn">
  <%= link_to("Back", (params[:report].nil? ? client_path(@client) : reports_path), {class: "btn btn-primary", role: "button"}) %>

  <% if @service.can_modify?  || current_user.has_role?(:admin) %>
    <%= link_to("Edit", edit_client_service_path(client_id: @client.id, id: @service.id), {class: "btn btn-default", role: "button"}) %>
  <% end %>
  
  <%= link_to("Cancel", client_service_path(client_id: @client.id, id: @service.id), {class: "btn btn-danger", role: "button", data: { confirm: "Are you sure want to cancel this service?" }, :method => :delete}) %>    

</div>
